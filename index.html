<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—¬ê¶Œì‚¬ì§„ ë³€í™˜ ë° ì¸ì‡„</title>
    <!-- styles ê°€ì ¸ì˜¤ê¸° -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“¸ ì—¬ê¶Œì‚¬ì§„ ë³€í™˜ê¸°</h1>
            <p>ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ë©´ ì—¬ê¶Œ ê·œê²©ì— ë§ê²Œ ìë™ ë³€í™˜í•˜ê³  A4ë¡œ ì¸ì‡„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
        </div>

        <div class="main-content">
            <div class="upload-area" onclick="document.getElementById('fileInput').click()" id="uploadArea">
                <div class="upload-icon">ğŸ“·</div>
                <div class="upload-text">ì‚¬ì§„ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•´ì„œ ì—…ë¡œë“œí•˜ì„¸ìš”</div>
                <div class="upload-hint">JPG, PNG íŒŒì¼ì„ ì§€ì›í•©ë‹ˆë‹¤</div>
                <input type="file" id="fileInput" accept="image/*">
            </div>

            <div class="photo-container" id="photoContainer">
                <div class="photo-preview">
                    <img id="previewImage" class="preview-image" alt="ë¯¸ë¦¬ë³´ê¸°">
                    <div style="margin-top: 10px; color: #666; font-size: 0.9rem;" id="imageInfo"></div>
                </div>

                <div class="controls">
                    <div class="control-group">
                        <h3>ğŸ“ í¬ê¸° ì„¤ì •</h3>
                        <div class="input-group">
                            <label for="widthInput">ë„ˆë¹„ (mm)</label>
                            <input type="number" id="widthInput" value="150" min="40" max="200">
                        </div>
                        <div class="input-group">
                            <label for="heightInput">ë†’ì´ (mm)</label>
                            <input type="number" id="heightInput" value="45" min="25" max="70" disabled style="background:#eee;">
                        </div>
                    </div>

                    <div class="control-group">
                        <h3>ğŸ¨ ìŠ¤íƒ€ì¼ ì„¤ì •</h3>
                        <div class="input-group">
                            <label for="borderRadius">ëª¨ì„œë¦¬ ë‘¥ê¸€ê¸° <span class="range-value" id="borderRadiusValue">16px</span></label>
                            <input type="range" id="borderRadius" min="0" max="16" value="16">
                        </div>
                        <div class="input-group">
                            <label for="borderWidth">í…Œë‘ë¦¬ ë‘ê»˜ <span class="range-value" id="borderWidthValue">1px</span></label>
                            <input type="range" id="borderWidth" min="1" max="5" value="1">
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="generatePhotos()">ğŸ”„ ì‚¬ì§„ ìƒì„±</button>
                    <button class="btn btn-primary" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°</button>
                    <button class="btn btn-secondary" onclick="resetAll()">ğŸ”„ ë‹¤ì‹œ ì‹œì‘</button>
                </div>

                <div class="print-area" id="printArea">
                    <!-- ë³€í™˜ëœ ì‚¬ì§„ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>

                <div class="info-card">
                    <h4>ğŸ’¡ ì‚¬ìš© íŒ</h4>
                    <ul>
                        <li>ì—¬ê¶Œ ì‚¬ì§„ í‘œì¤€ í¬ê¸°ëŠ” 35Ã—45mmì…ë‹ˆë‹¤</li>
                        <li>í…Œë‘ë¦¬ì™€ ë‘¥ê·¼ ëª¨ì„œë¦¬ëŠ” ìŠ¤ìº”í•  ë•Œ ê²½ê³„ë¥¼ ëª…í™•í•˜ê²Œ í•´ì¤ë‹ˆë‹¤</li>
                        <li>A4 ìš©ì§€ì— ì¸ì‡„ í›„ ì •í™•í•œ í¬ê¸°ë¡œ ì˜ë¼ë‚´ì„¸ìš”</li>
                        <li>ì¸ì‡„ ì‹œ 'ì‹¤ì œ í¬ê¸°'ë¡œ ì„¤ì •í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        let uploadedImage = null;

        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        const fileInput = document.getElementById('fileInput');
        const uploadArea = document.getElementById('uploadArea');
        const photoContainer = document.getElementById('photoContainer');
        const previewImage = document.getElementById('previewImage');
        const imageInfo = document.getElementById('imageInfo');

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì²˜ë¦¬
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        function handleFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                uploadedImage = new Image();
                uploadedImage.onload = () => {
                    previewImage.src = e.target.result;
                    imageInfo.textContent = `ì›ë³¸ í¬ê¸°: ${uploadedImage.width} Ã— ${uploadedImage.height}px`;
                    photoContainer.style.display = 'block';
                    generatePhotos();
                };
                uploadedImage.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // ë²”ìœ„ ìŠ¬ë¼ì´ë” ê°’ í‘œì‹œ ì—…ë°ì´íŠ¸
        document.getElementById('borderRadius').addEventListener('input', function() {
            document.getElementById('borderRadiusValue').textContent = this.value + 'px';
            generatePhotos();
        });

        document.getElementById('borderWidth').addEventListener('input', function() {
            document.getElementById('borderWidthValue').textContent = this.value + 'px';
            generatePhotos();
        });

        // í¬ê¸° ì…ë ¥ ë³€ê²½ ì‹œ ìë™ ì—…ë°ì´íŠ¸
    document.getElementById('widthInput').addEventListener('input', generatePhotos);
    // ë†’ì´ ì…ë ¥ì€ ìë™ ê³„ì‚°ì´ë¯€ë¡œ ì´ë²¤íŠ¸ ì œê±°

        function generatePhotos() {
            if (!uploadedImage) return;

            const width = parseInt(document.getElementById('widthInput').value);
            // ì´ë¯¸ì§€ ë¹„ìœ¨ì— ë§ê²Œ ë†’ì´ ìë™ ê³„ì‚°
            let height = 45;
            if (uploadedImage) {
                height = Math.round(width * (uploadedImage.height / uploadedImage.width));
                document.getElementById('heightInput').value = height;
            }
            const borderRadius = parseInt(document.getElementById('borderRadius').value);
            const borderWidth = parseInt(document.getElementById('borderWidth').value);

            // mmë¥¼ í”½ì…€ë¡œ ë³€í™˜ (300 DPI ê¸°ì¤€)
            const widthPx = Math.round(width * 11.811); // 1mm = 11.811px at 300 DPI
            const heightPx = Math.round(height * 11.811);

            const printArea = document.getElementById('printArea');
            printArea.innerHTML = '';

            // ìº”ë²„ìŠ¤ë¡œ ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì¦ˆ
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = widthPx;
            canvas.height = heightPx;

            // ì´ë¯¸ì§€ë¥¼ ìº”ë²„ìŠ¤ í¬ê¸°ì— ë§ê²Œ ê·¸ë¦¬ê¸° (ë¹„ìœ¨ ìœ ì§€í•˜ë©° í¬ë¡­)
            const scale = Math.max(widthPx / uploadedImage.width, heightPx / uploadedImage.height);
            const scaledWidth = uploadedImage.width * scale;
            const scaledHeight = uploadedImage.height * scale;
            const offsetX = (widthPx - scaledWidth) / 2;
            const offsetY = (heightPx - scaledHeight) / 2;

            ctx.drawImage(uploadedImage, offsetX, offsetY, scaledWidth, scaledHeight);

            const resizedImageUrl = canvas.toDataURL('image/jpeg', 0.9);

            // A4 ìš©ì§€ì— 1ê°œ ì‚¬ì§„ë§Œ ê°€ìš´ë° ë°°ì¹˜
            const totalPhotos = 1;

            // ì‚¬ì§„ ë°°ì¹˜ - ê°€ìš´ë° ì •ë ¬
            printArea.style.display = 'flex';
            printArea.style.justifyContent = 'center';
            printArea.style.alignItems = 'center';

            const photoDiv = document.createElement('div');
            photoDiv.className = 'passport-photo';
            photoDiv.style.border = `${borderWidth}px solid #333`;
            photoDiv.style.borderRadius = `${borderRadius}px`;
            photoDiv.style.padding = '0';
            photoDiv.style.overflow = 'hidden';

            const img = document.createElement('img');
            img.src = resizedImageUrl;
            img.style.width = `${widthPx / 3.78}px`; // í™”ë©´ í‘œì‹œìš© í¬ê¸° ì¡°ì •
            img.style.height = `${heightPx / 3.78}px`;
            img.style.borderRadius = '0';
            img.style.display = 'block';

            photoDiv.appendChild(img);
            printArea.appendChild(photoDiv);

            // ì •ë³´ í‘œì‹œ
            document.querySelector('.info-card ul').innerHTML = `
                <li>ì‚¬ì§„ í¬ê¸°: ${width} Ã— ${height}mm</li>
                <li>A4 ìš©ì§€ ê°€ìš´ë°ì— 1ê°œ ì‚¬ì§„ ë°°ì¹˜</li>
                <li>í…Œë‘ë¦¬ ë‘ê»˜: ${borderWidth}px, ëª¨ì„œë¦¬ ë‘¥ê¸€ê¸°: ${borderRadius}px</li>
                <li>ì¸ì‡„ í›„ ì •í™•í•œ í¬ê¸°ë¡œ ì˜ë¼ë‚´ì„¸ìš”</li>
            `;
        }

        function resetAll() {
            uploadedImage = null;
            photoContainer.style.display = 'none';
            previewImage.src = '';
            document.getElementById('printArea').innerHTML = '';
            fileInput.value = '';
            
            // ê¸°ë³¸ê°’ìœ¼ë¡œ ë¦¬ì…‹
            document.getElementById('widthInput').value = 150;
            document.getElementById('borderRadius').value = 16;
            document.getElementById('borderWidth').value = 1;

            
            // í‘œì‹œê°’ ì—…ë°ì´íŠ¸
            document.getElementById('borderRadiusValue').textContent = '16px';
            document.getElementById('borderWidthValue').textContent = '1px';
  
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ê°’ í‘œì‹œ
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('borderRadiusValue').textContent = '16px';
            document.getElementById('borderWidthValue').textContent = '1px';
        });
    </script>
</body>
</html>